<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Quality Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f8fafc; border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Fade-in Animation for Table Rows */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }

        /* Glassmorphism Effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-100 to-slate-200 p-6 font-sans text-slate-800">
    <div class="max-w-6xl mx-auto space-y-6">
        
        <!-- Header -->
        <div>
            <h1 class="text-2xl font-bold text-slate-900 flex items-center gap-2">
                <i data-lucide="wind" class="text-blue-500"></i> Air Quality Tracker
            </h1>
            <p class="text-sm text-slate-500 mt-1">Monitoring PM2.5, PM10, and overall AQI across cities.</p>
        </div>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="glass-card p-5 rounded-xl shadow-sm flex items-center gap-4">
                <div class="p-3 bg-blue-50 text-blue-600 rounded-lg"><i data-lucide="map-pin" class="w-6 h-6"></i></div>
                <div>
                    <p class="text-sm text-slate-500 font-medium">Cities Tracked</p>
                    <p id="kpi-cities" class="text-2xl font-bold text-slate-900">0</p>
                </div>
            </div>
            <div class="glass-card p-5 rounded-xl shadow-sm flex items-center gap-4">
                <div class="p-3 bg-indigo-50 text-indigo-600 rounded-lg"><i data-lucide="activity" class="w-6 h-6"></i></div>
                <div>
                    <p class="text-sm text-slate-500 font-medium">Avg AQI (Filtered)</p>
                    <p id="kpi-avg" class="text-2xl font-bold text-slate-900">0</p>
                </div>
            </div>
            <div class="glass-card p-5 rounded-xl shadow-sm flex items-center gap-4">
                <div class="p-3 bg-rose-50 text-rose-600 rounded-lg"><i data-lucide="alert-triangle" class="w-6 h-6"></i></div>
                <div>
                    <p class="text-sm text-slate-500 font-medium">Max AQI (Filtered)</p>
                    <p id="kpi-max" class="text-2xl font-bold text-slate-900">0</p>
                </div>
            </div>
        </div>

        <!-- Main Data Section -->
        <div class="glass-card rounded-xl shadow-sm overflow-hidden">
            
            <!-- Toolbar -->
            <div class="p-4 border-b border-slate-200 bg-white/50 flex flex-col sm:flex-row gap-4 justify-between items-center">
                <div class="relative w-full sm:w-72">
                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4"></i>
                    <input 
                        type="text" 
                        id="searchInput"
                        placeholder="Search by city..." 
                        class="w-full pl-10 pr-4 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
                    />
                </div>
                <div class="flex items-center gap-2 w-full sm:w-auto">
                    <i data-lucide="filter" class="text-slate-400 w-4 h-4"></i>
                    <select 
                        id="filterSelect"
                        class="w-full sm:w-auto py-2 pl-3 pr-8 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white"
                    >
                        <option value="All">All</option>
                        <option value="Good">Good</option>
                        <option value="Satisfactory">Satisfactory</option>
                        <option value="Moderate">Moderate</option>
                        <option value="Poor">Poor</option>
                        <option value="Very Poor">Very Poor</option>
                        <option value="Severe">Severe</option>
                        <option value="Unknown">Unknown</option>
                    </select>
                </div>
            </div>

            <!-- Data Table -->
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-white border-b border-slate-200 text-xs uppercase tracking-wider text-slate-500 font-semibold">
                            <th class="p-4 pl-6">City</th>
                            <th class="p-4">Date</th>
                            <th class="p-4">AQI Value</th>
                            <th class="p-4">Condition</th>
                            <th class="p-4">PM2.5</th>
                            <th class="p-4">PM10</th>
                            <th class="p-4">CO</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-slate-100">
                        <!-- Rows rendered via JS -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="p-4 border-t border-slate-200 bg-white flex items-center justify-between">
                <span class="text-sm text-slate-500">
                    Showing <span id="pageStart" class="font-medium text-slate-900">0</span> to 
                    <span id="pageEnd" class="font-medium text-slate-900">0</span> of 
                    <span id="pageTotal" class="font-medium text-slate-900">0</span>
                </span>
                <div class="flex gap-1">
                    <button id="btnPrev" class="p-1.5 rounded-md border border-slate-200 text-slate-500 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="chevron-left" class="w-4 h-4"></i>
                    </button>
                    <button id="btnNext" class="p-1.5 rounded-md border border-slate-200 text-slate-500 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // Data
        const airQualityData = [
            { City: 'Delhi', Date: '2020-07-01', AQI: 101, AQI_Bucket: 'Moderate', 'PM2.5': 45.2, PM10: 98.4, CO: 1.2, SO2: 14.5 },
            { City: 'Ahmedabad', Date: '2020-07-01', AQI: 235, AQI_Bucket: 'Poor', 'PM2.5': 88.5, PM10: 145.2, CO: 2.1, SO2: 45.1 },
            { City: 'Bengaluru', Date: '2020-07-01', AQI: 55, AQI_Bucket: 'Satisfactory', 'PM2.5': 22.1, PM10: 50.3, CO: 0.8, SO2: 5.2 },
            { City: 'Mumbai', Date: '2020-07-01', AQI: 88, AQI_Bucket: 'Satisfactory', 'PM2.5': 35.4, PM10: 75.1, CO: 1.1, SO2: 12.0 },
            { City: 'Chennai', Date: '2020-07-01', AQI: 120, AQI_Bucket: 'Moderate', 'PM2.5': 55.6, PM10: 110.2, CO: 1.5, SO2: 18.3 },
            { City: 'Lucknow', Date: '2020-07-01', AQI: 310, AQI_Bucket: 'Very Poor', 'PM2.5': 150.2, PM10: 250.4, CO: 3.5, SO2: 55.2 },
            { City: 'Patna', Date: '2020-07-01', AQI: 415, AQI_Bucket: 'Severe', 'PM2.5': 280.5, PM10: 380.1, CO: 4.2, SO2: 68.9 },
            { City: 'Hyderabad', Date: '2020-07-01', AQI: 72, AQI_Bucket: 'Satisfactory', 'PM2.5': 28.9, PM10: 65.4, CO: 0.9, SO2: 8.5 },
            { City: 'Delhi', Date: '2020-06-30', AQI: 155, AQI_Bucket: 'Moderate', 'PM2.5': 65.2, PM10: 120.4, CO: 1.4, SO2: 16.5 },
            { City: 'Ahmedabad', Date: '2020-06-30', AQI: 198, AQI_Bucket: 'Moderate', 'PM2.5': 80.5, PM10: 135.2, CO: 1.9, SO2: 40.1 },
        ];

        // State variables
        let searchTerm = '';
        let bucketFilter = 'All';
        let currentPage = 1;
        const itemsPerPage = 5;
        let filteredData = [];

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const filterSelect = document.getElementById('filterSelect');
        const tableBody = document.getElementById('tableBody');
        const btnPrev = document.getElementById('btnPrev');
        const btnNext = document.getElementById('btnNext');

        // Helper for badges
        function getAQIColor(bucket) {
            switch (bucket) {
                case 'Good': return 'bg-green-100 text-green-800 border-green-200';
                case 'Satisfactory': return 'bg-emerald-100 text-emerald-800 border-emerald-200';
                case 'Moderate': return 'bg-yellow-100 text-yellow-800 border-yellow-200';
                case 'Poor': return 'bg-orange-100 text-orange-800 border-orange-200';
                case 'Very Poor': return 'bg-red-100 text-red-800 border-red-200';
                case 'Severe': return 'bg-rose-900 text-rose-100 border-rose-950';
                default: return 'bg-gray-100 text-gray-800 border-gray-200';
            }
        }

        // Core logic
        function updateData() {
            // 1. Filter
            filteredData = airQualityData.filter(item => {
                const matchesSearch = item.City.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesBucket = bucketFilter === 'All' || item.AQI_Bucket === bucketFilter;
                return matchesSearch && matchesBucket;
            });

            // 2. Metrics
            const uniqueCities = new Set(filteredData.map(d => d.City)).size;
            const totalAQI = filteredData.reduce((acc, curr) => acc + curr.AQI, 0);
            const avgAQI = filteredData.length ? Math.round(totalAQI / filteredData.length) : 0;
            const maxAQI = filteredData.length ? Math.max(...filteredData.map(d => d.AQI)) : 0;

            document.getElementById('kpi-cities').textContent = uniqueCities;
            document.getElementById('kpi-avg').textContent = avgAQI;
            document.getElementById('kpi-max').textContent = maxAQI;

            // 3. Render Table
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage > totalPages && totalPages > 0) currentPage = totalPages;
            
            const startIdx = (currentPage - 1) * itemsPerPage;
            const paginatedData = filteredData.slice(startIdx, startIdx + itemsPerPage);

            tableBody.innerHTML = '';
            if (paginatedData.length === 0) {
                tableBody.innerHTML = `<tr><td colSpan="7" class="p-8 text-center text-slate-500">No records found matching your criteria.</td></tr>`;
            } else {
                paginatedData.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    // Added fade-in animation with staggered delay based on index
                    tr.className = 'hover:bg-slate-50/80 transition-colors animate-fade-in';
                    tr.style.animationDelay = `${index * 0.05}s`;
                    tr.style.opacity = '0'; // Start hidden for the animation
                    tr.innerHTML = `
                        <td class="p-4 pl-6 font-medium text-slate-900">${row.City}</td>
                        <td class="p-4 text-sm text-slate-600">${row.Date}</td>
                        <td class="p-4"><span class="font-bold text-slate-700">${Math.round(row.AQI)}</span></td>
                        <td class="p-4">
                            <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border ${getAQIColor(row.AQI_Bucket)}">
                                ${row.AQI_Bucket}
                            </span>
                        </td>
                        <td class="p-4 text-sm text-slate-600">${row['PM2.5']}</td>
                        <td class="p-4 text-sm text-slate-600">${row.PM10}</td>
                        <td class="p-4 text-sm text-slate-600">${row.CO}</td>
                    `;
                    tableBody.appendChild(tr);
                });
            }

            // 4. Update Pagination UI
            document.getElementById('pageStart').textContent = filteredData.length === 0 ? 0 : startIdx + 1;
            document.getElementById('pageEnd').textContent = Math.min(currentPage * itemsPerPage, filteredData.length);
            document.getElementById('pageTotal').textContent = filteredData.length;

            btnPrev.disabled = currentPage === 1;
            btnNext.disabled = currentPage === totalPages || totalPages === 0;
        }

        // Event Listeners
        searchInput.addEventListener('input', (e) => {
            searchTerm = e.target.value;
            currentPage = 1;
            updateData();
        });

        filterSelect.addEventListener('change', (e) => {
            bucketFilter = e.target.value;
            currentPage = 1;
            updateData();
        });

        btnPrev.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                updateData();
            }
        });

        btnNext.addEventListener('click', () => {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                updateData();
            }
        });

        // Initial render
        updateData();
    </script>
</body>
</html>